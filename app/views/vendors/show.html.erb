<!DOCTYPE html>
<html>
<head>
  <title>All about <%= @vendor.name %></title>
</head>

<body>
  <% current_user = (session[:vendor_id] == @vendor.id) %>

  <h1><%= @vendor.name %></h1>
  <blockquote><%= @vendor.description %></blockquote>

  List of all products: <a href="/vendors/<%=@vendor.id%>/my_products">My products</a>
  Email <a href="mailto:<%= @vendor.email %>"><%= @vendor.name %></a> or call <%= @vendor.phone %>.
  <% if @vendor.market_id %>
    <% @market = Market.find(@vendor.market_id) %>
    Or go find <a href="<%= @vendor.website %>"><%= @vendor.name %></a> at <a href="/markets/<%= @market.id %>"><%= @market.name %></a>.
  <% else %>
  <% end %>
  <h2><%= @vendor.name %>'s Products</h2>
  <ul><% Product.where(vendor_id: @vendor.id).each do |product| %>
    <li><a href = <%= product.path %> ><%= product.name %></a> &mdash; <%= number_to_currency(product.price) %>
      <% if current_user %>
      <a class="button" href= "sales/new/<%= product.id %>">Record Sale</a>
      <a class="button" href= <%= product.edit_path %> >Edit</a>
      <a class="button" href= <%= product.delete_path %> >Delete </a>
      <% end %> </li>
    <% end %>
  </ul>

  <% if current_user %>
    Here is your vendor ID: <%=@vendor.id%><br>
    <a href="/vendors/<%=@vendor.id%>/add_product">Add a product</a>
    <a href="/vendors/<%=@vendor.id%>/edit">Edit</a>
    <a href="/vendors/<%=@vendor.id%>/destroy">Delete</a><br>
    <a href="/vendors/<%=@vendor.id%>/sales">Sales Record</a><br>
  <% end %>
  <a href="/vendors">Back to Vendor list</a>
</body>
</html>
